Warning: Map Join MAPJOIN[185][bigTable=?] in task 'Map 1' is a cross product
Warning: Map Join MAPJOIN[184][bigTable=?] in task 'Map 1' is a cross product
Warning: Map Join MAPJOIN[183][bigTable=?] in task 'Map 1' is a cross product
Warning: Map Join MAPJOIN[182][bigTable=?] in task 'Map 1' is a cross product
Warning: Map Join MAPJOIN[181][bigTable=?] in task 'Map 1' is a cross product
Warning: Map Join MAPJOIN[180][bigTable=?] in task 'Map 1' is a cross product
Warning: Map Join MAPJOIN[179][bigTable=?] in task 'Map 1' is a cross product
Warning: Map Join MAPJOIN[178][bigTable=?] in task 'Map 1' is a cross product
Warning: Map Join MAPJOIN[177][bigTable=?] in task 'Map 1' is a cross product
Warning: Map Join MAPJOIN[176][bigTable=?] in task 'Map 1' is a cross product
Warning: Map Join MAPJOIN[175][bigTable=?] in task 'Map 1' is a cross product
Warning: Map Join MAPJOIN[174][bigTable=?] in task 'Map 1' is a cross product
Warning: Map Join MAPJOIN[173][bigTable=?] in task 'Map 1' is a cross product
Warning: Map Join MAPJOIN[172][bigTable=?] in task 'Map 1' is a cross product
Warning: Map Join MAPJOIN[171][bigTable=?] in task 'Map 1' is a cross product
PREHOOK: query: explain cbo
select case when (select count(*) 
                  from store_sales 
                  where ss_quantity between 1 and 20) > 409437
            then (select avg(ss_ext_list_price) 
                  from store_sales 
                  where ss_quantity between 1 and 20) 
            else (select avg(ss_net_paid_inc_tax)
                  from store_sales
                  where ss_quantity between 1 and 20) end bucket1 ,
       case when (select count(*)
                  from store_sales
                  where ss_quantity between 21 and 40) > 4595804
            then (select avg(ss_ext_list_price)
                  from store_sales
                  where ss_quantity between 21 and 40) 
            else (select avg(ss_net_paid_inc_tax)
                  from store_sales
                  where ss_quantity between 21 and 40) end bucket2,
       case when (select count(*)
                  from store_sales
                  where ss_quantity between 41 and 60) > 7887297
            then (select avg(ss_ext_list_price)
                  from store_sales
                  where ss_quantity between 41 and 60)
            else (select avg(ss_net_paid_inc_tax)
                  from store_sales
                  where ss_quantity between 41 and 60) end bucket3,
       case when (select count(*)
                  from store_sales
                  where ss_quantity between 61 and 80) > 10872978
            then (select avg(ss_ext_list_price)
                  from store_sales
                  where ss_quantity between 61 and 80)
            else (select avg(ss_net_paid_inc_tax)
                  from store_sales
                  where ss_quantity between 61 and 80) end bucket4,
       case when (select count(*)
                  from store_sales
                  where ss_quantity between 81 and 100) > 43571537
            then (select avg(ss_ext_list_price)
                  from store_sales
                  where ss_quantity between 81 and 100)
            else (select avg(ss_net_paid_inc_tax)
                  from store_sales
                  where ss_quantity between 81 and 100) end bucket5
from reason
where r_reason_sk = 1
PREHOOK: type: QUERY
PREHOOK: Input: default@reason
PREHOOK: Input: default@store_sales
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: explain cbo
select case when (select count(*) 
                  from store_sales 
                  where ss_quantity between 1 and 20) > 409437
            then (select avg(ss_ext_list_price) 
                  from store_sales 
                  where ss_quantity between 1 and 20) 
            else (select avg(ss_net_paid_inc_tax)
                  from store_sales
                  where ss_quantity between 1 and 20) end bucket1 ,
       case when (select count(*)
                  from store_sales
                  where ss_quantity between 21 and 40) > 4595804
            then (select avg(ss_ext_list_price)
                  from store_sales
                  where ss_quantity between 21 and 40) 
            else (select avg(ss_net_paid_inc_tax)
                  from store_sales
                  where ss_quantity between 21 and 40) end bucket2,
       case when (select count(*)
                  from store_sales
                  where ss_quantity between 41 and 60) > 7887297
            then (select avg(ss_ext_list_price)
                  from store_sales
                  where ss_quantity between 41 and 60)
            else (select avg(ss_net_paid_inc_tax)
                  from store_sales
                  where ss_quantity between 41 and 60) end bucket3,
       case when (select count(*)
                  from store_sales
                  where ss_quantity between 61 and 80) > 10872978
            then (select avg(ss_ext_list_price)
                  from store_sales
                  where ss_quantity between 61 and 80)
            else (select avg(ss_net_paid_inc_tax)
                  from store_sales
                  where ss_quantity between 61 and 80) end bucket4,
       case when (select count(*)
                  from store_sales
                  where ss_quantity between 81 and 100) > 43571537
            then (select avg(ss_ext_list_price)
                  from store_sales
                  where ss_quantity between 81 and 100)
            else (select avg(ss_net_paid_inc_tax)
                  from store_sales
                  where ss_quantity between 81 and 100) end bucket5
from reason
where r_reason_sk = 1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@reason
POSTHOOK: Input: default@store_sales
POSTHOOK: Output: hdfs://### HDFS PATH ###
CBO PLAN:
HiveProject(bucket1=[CASE(>($1, 409437), $2, $3)], bucket2=[CASE(>($4, 4595804), $5, $6)], bucket3=[CASE(>($7, 7887297), $8, $9)], bucket4=[CASE(>($10, 10872978), $11, $12)], bucket5=[CASE(>($13, 43571537), $14, $15)])
  HiveJoin(condition=[true], joinType=[left], algorithm=[none], cost=[not available])
    HiveJoin(condition=[true], joinType=[left], algorithm=[none], cost=[not available])
      HiveJoin(condition=[true], joinType=[left], algorithm=[none], cost=[not available])
        HiveJoin(condition=[true], joinType=[left], algorithm=[none], cost=[not available])
          HiveJoin(condition=[true], joinType=[left], algorithm=[none], cost=[not available])
            HiveJoin(condition=[true], joinType=[left], algorithm=[none], cost=[not available])
              HiveJoin(condition=[true], joinType=[left], algorithm=[none], cost=[not available])
                HiveJoin(condition=[true], joinType=[left], algorithm=[none], cost=[not available])
                  HiveJoin(condition=[true], joinType=[left], algorithm=[none], cost=[not available])
                    HiveJoin(condition=[true], joinType=[left], algorithm=[none], cost=[not available])
                      HiveJoin(condition=[true], joinType=[left], algorithm=[none], cost=[not available])
                        HiveJoin(condition=[true], joinType=[left], algorithm=[none], cost=[not available])
                          HiveJoin(condition=[true], joinType=[left], algorithm=[none], cost=[not available])
                            HiveJoin(condition=[true], joinType=[left], algorithm=[none], cost=[not available])
                              HiveJoin(condition=[true], joinType=[left], algorithm=[none], cost=[not available])
                                HiveProject(r_reason_sk=[CAST(1):INTEGER])
                                  HiveFilter(condition=[=($0, 1)])
                                    HiveTableScan(table=[[default, reason]], table:alias=[reason])
                                HiveProject($f0=[$0])
                                  HiveAggregate(group=[{}], agg#0=[count()])
                                    HiveFilter(condition=[BETWEEN(false, $10, 1, 20)])
                                      HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                              HiveProject($f0=[/($0, $1)])
                                HiveAggregate(group=[{}], agg#0=[sum($17)], agg#1=[count($17)])
                                  HiveFilter(condition=[BETWEEN(false, $10, 1, 20)])
                                    HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                            HiveProject($f0=[/($0, $1)])
                              HiveAggregate(group=[{}], agg#0=[sum($21)], agg#1=[count($21)])
                                HiveFilter(condition=[BETWEEN(false, $10, 1, 20)])
                                  HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                          HiveProject($f0=[$0])
                            HiveAggregate(group=[{}], agg#0=[count()])
                              HiveFilter(condition=[BETWEEN(false, $10, 21, 40)])
                                HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                        HiveProject($f0=[/($0, $1)])
                          HiveAggregate(group=[{}], agg#0=[sum($17)], agg#1=[count($17)])
                            HiveFilter(condition=[BETWEEN(false, $10, 21, 40)])
                              HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                      HiveProject($f0=[/($0, $1)])
                        HiveAggregate(group=[{}], agg#0=[sum($21)], agg#1=[count($21)])
                          HiveFilter(condition=[BETWEEN(false, $10, 21, 40)])
                            HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                    HiveProject($f0=[$0])
                      HiveAggregate(group=[{}], agg#0=[count()])
                        HiveFilter(condition=[BETWEEN(false, $10, 41, 60)])
                          HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                  HiveProject($f0=[/($0, $1)])
                    HiveAggregate(group=[{}], agg#0=[sum($17)], agg#1=[count($17)])
                      HiveFilter(condition=[BETWEEN(false, $10, 41, 60)])
                        HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                HiveProject($f0=[/($0, $1)])
                  HiveAggregate(group=[{}], agg#0=[sum($21)], agg#1=[count($21)])
                    HiveFilter(condition=[BETWEEN(false, $10, 41, 60)])
                      HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
              HiveProject($f0=[$0])
                HiveAggregate(group=[{}], agg#0=[count()])
                  HiveFilter(condition=[BETWEEN(false, $10, 61, 80)])
                    HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
            HiveProject($f0=[/($0, $1)])
              HiveAggregate(group=[{}], agg#0=[sum($17)], agg#1=[count($17)])
                HiveFilter(condition=[BETWEEN(false, $10, 61, 80)])
                  HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
          HiveProject($f0=[/($0, $1)])
            HiveAggregate(group=[{}], agg#0=[sum($21)], agg#1=[count($21)])
              HiveFilter(condition=[BETWEEN(false, $10, 61, 80)])
                HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
        HiveProject($f0=[$0])
          HiveAggregate(group=[{}], agg#0=[count()])
            HiveFilter(condition=[BETWEEN(false, $10, 81, 100)])
              HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
      HiveProject($f0=[/($0, $1)])
        HiveAggregate(group=[{}], agg#0=[sum($17)], agg#1=[count($17)])
          HiveFilter(condition=[BETWEEN(false, $10, 81, 100)])
            HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
    HiveProject($f0=[/($0, $1)])
      HiveAggregate(group=[{}], agg#0=[sum($21)], agg#1=[count($21)])
        HiveFilter(condition=[BETWEEN(false, $10, 81, 100)])
          HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])

